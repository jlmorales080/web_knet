@using Umbraco.Cms.Core.Models.Blocks
@using Umbraco.Cms.Web.Common.PublishedModels
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage<BlockListItem>

@{
    var content = Model.Content;
    var title = content.Value<string>("title");
    
    // Assuming 'cards' is a nested Block List (Block List inside Block List) or similar repeater
    var cards = content.Value<IEnumerable<BlockListItem>>("cards");
}

<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module">
    <section class="ofertas_destacadas bg-deco-ofertas">
        <div class="wrapper">
            <div class="title">
                <p>@title</p>
            </div>

            <div class="inner-cards">
                @if (cards != null)
                {
                    foreach (var item in cards)
                    {
                        var card = item.Content;
                        // Assuming properties: price (string), priceDecimal (string), period (string), oldPrice (string), title (string), features (RichText), ctaLink (Link)
                        
                        var price = card.Value<string>("price");
                        var priceDecimal = card.Value<string>("priceDecimal");
                        var period = card.Value<string>("period");
                        var oldPrice = card.Value<string>("oldPrice");
                        var cardTitle = card.Value<string>("title");
                        var features = card.Value<string>("features"); // Fetch as string
                        var ctaLink = card.Value<Umbraco.Cms.Core.Models.Link>("ctaLink");
                        
                        <div class="card">
                            <div>
                                <div class="card-precio">
                                    <div>
                                        <div class="precio">
                                            @price
                                            <div style="display: flex; flex-direction: column; justify-content: space-between">
                                                <sup>@priceDecimal</sup>
                                                <sub>@period</sub>
                                            </div>
                                        </div>
                                        @if (!string.IsNullOrEmpty(oldPrice))
                                        {
                                            <span class="antes">@oldPrice</span>
                                        }
                                        <p class="tarifa">@cardTitle.ToUpper()</p>
                                    </div>
                                </div>

                                <div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_inline_rich_text">
                                     @Html.Raw(features)
                                </div>
                            </div>

                            <div>
                                @if (ctaLink != null)
                                {
                                    <a href="@ctaLink.Url" class="btn-blue-icon" target="@ctaLink.Target">
                                        @ctaLink.Name
                                    </a>
                                }
                            </div>
                        </div>
                    }
                }
            </div>
        </div>
    </section>
</div>
